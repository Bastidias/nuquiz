
> nuquiz@0.1.0 test
> NODE_ENV=test jest knowledge.int.test.ts

  console.log
    [dotenv@17.2.3] injecting env (6) from .env -- tip: üîê prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    ‚úì Jest setup complete - using test database on port 5433

      at Object.<anonymous> (jest.setup.js:26:9)

  console.log
    ‚úì NO MOCKS - Testing against real PostgreSQL instance

      at Object.<anonymous> (jest.setup.js:27:9)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.error
    Database query error: error: relation "analytics_events" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at truncateAllTables (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/helpers/cleanup.ts:15:3)
        at Object.beforeAll (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/helpers/cleanup.ts:136:5)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:18:5) {
      length: 114,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'namespace.c',
      line: '434',
      routine: 'RangeVarGetRelidExtended'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "knowledge" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:37:5) {
      length: 108,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: '13',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '1449',
      routine: 'parserOpenTable'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  console.error
    Database query error: error: relation "analytics_events" does not exist
        at /home/matt/dev/nudev/nuquiz/nuquiz/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at query (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/connection.ts:112:20)
        at truncateAllTables (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/helpers/cleanup.ts:15:3)
        at Object.afterAll (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/helpers/cleanup.ts:150:5)
        at Object.<anonymous> (/home/matt/dev/nudev/nuquiz/nuquiz/src/db/__tests__/knowledge.int.test.ts:41:5) {
      length: 114,
      severity: 'ERROR',
      code: '42P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'namespace.c',
      line: '434',
      routine: 'RangeVarGetRelidExtended'
    }

      118 |   } catch (error) {
      119 |     // Log error but let it bubble up for handling
    > 120 |     console.error('Database query error:', error);
          |             ^
      121 |     throw error;
      122 |   }
      123 | };

      at query (src/db/connection.ts:120:13)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.afterAll (src/db/__tests__/helpers/cleanup.ts:150:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:41:5)

FAIL src/db/__tests__/knowledge.int.test.ts
  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create a topic at root level

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create a topic at root level

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create nested topics

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create nested topics

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create category under topic (valid hierarchy)

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create category under topic (valid hierarchy)

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should REJECT category without topic parent

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should REJECT category without topic parent

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create full hierarchy: topic ‚Üí category ‚Üí attribute ‚Üí fact

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should create full hierarchy: topic ‚Üí category ‚Üí attribute ‚Üí fact

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should REJECT attribute under topic (invalid hierarchy)

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Hierarchy Validation (ENFORCED BY DATABASE) ‚Ä∫ should REJECT attribute under topic (invalid hierarchy)

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find knowledge by ID

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find knowledge by ID

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find all knowledge of a specific type

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find all knowledge of a specific type

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find all children of a parent node

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find all children of a parent node

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find facts by category + attribute path (QUIZ GENERATION)

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should find facts by category + attribute path (QUIZ GENERATION)

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should build path notation for quiz questions

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should build path notation for quiz questions

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should get entire subtree recursively

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Query Functions (REAL DATABASE QUERIES) ‚Ä∫ should get entire subtree recursively

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Mutation Functions (REAL DATABASE WRITES) ‚Ä∫ should update a knowledge node

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Mutation Functions (REAL DATABASE WRITES) ‚Ä∫ should update a knowledge node

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Mutation Functions (REAL DATABASE WRITES) ‚Ä∫ should delete a knowledge node (CASCADE)

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Mutation Functions (REAL DATABASE WRITES) ‚Ä∫ should delete a knowledge node (CASCADE)

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Mutation Functions (REAL DATABASE WRITES) ‚Ä∫ should reorder children

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Mutation Functions (REAL DATABASE WRITES) ‚Ä∫ should reorder children

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Aggregate Queries (REAL DATABASE ANALYTICS) ‚Ä∫ should count knowledge nodes by type

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.beforeAll (src/db/__tests__/helpers/cleanup.ts:136:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:18:5)

  ‚óè Knowledge DAL - Integration Tests (NO MOCKS) ‚Ä∫ Aggregate Queries (REAL DATABASE ANALYTICS) ‚Ä∫ should count knowledge nodes by type

    error: relation "knowledge" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:37:5)


  ‚óè Test suite failed to run

    error: relation "analytics_events" does not exist

      110 |
      111 |   try {
    > 112 |     const result = await pool.query<T>(text, params);
          |                    ^
      113 |     return {
      114 |       rows: result.rows,
      115 |       rowCount: result.rowCount || 0,

      at node_modules/pg-pool/index.js:45:11
      at query (src/db/connection.ts:112:20)
      at truncateAllTables (src/db/__tests__/helpers/cleanup.ts:15:3)
      at Object.afterAll (src/db/__tests__/helpers/cleanup.ts:150:5)
      at Object.<anonymous> (src/db/__tests__/knowledge.int.test.ts:41:5)

Test Suites: 1 failed, 1 total
Tests:       16 failed, 16 total
Snapshots:   0 total
Time:        0.536 s
Ran all test suites matching knowledge.int.test.ts.
